<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="report">
	<insert id="insert">
		insert into report(report_no, member_no, report_content, report_member_no, report_table_no, report_table)
		 values(report_seq.nextval, #{memberNo}, #{reportContent}, #{reportMemberNo}, #{reportTableNo}, #{reportTable})
	</insert>
	<update id="update">
		update report set report_content=#{reportContent}, report_time=sysdate where member_no=#{memberNo} and report_table_no=#{reportTableNo} and report_table=#{reportTable}
	</update>
	<select id="selectOne" resultType="ReportDto">
		select * from report where member_no=#{memberNo} and report_table_no=#{reportTableNo} and report_table=#{reportTable}
	</select>
	
	<sql id="topNheader">
	 	select * from (
			select rownum rn, TMP.* from(
	</sql>
	<sql id="topNfooter">
			)TMP
	 	)where rn between #{begin} and #{end}
	</sql>
	
	<select id="selectList" resultType="ReportDto">
		<include refid="topNheader"></include>
			select * from report
			<if test="column!=null and keyword!=null"> 
				where instr(${column}, #{keyword})>0
			</if>
			order by report_no asc
		<include refid="topNfooter"></include>	
	</select>

</mapper>